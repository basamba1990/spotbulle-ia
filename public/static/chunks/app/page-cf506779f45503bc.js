(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{792:function(e,t,s){Promise.resolve().then(s.bind(s,1567))},1567:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var a=s(7437),l=s(2265),r=s(9376),i=s(7648),n=s(2950),c=s(5725),d=s(5864);function o(e){let{onUploadSuccess:t,onUploadError:s}=e,[r,i]=(0,l.useState)(!1),[n,o]=(0,l.useState)(0),[m,x]=(0,l.useState)(null),[u,h]=(0,l.useState)(null),[p,v]=(0,l.useState)({titre:"",description:"",thematique:"autre",tags:[],evenement_id:"",parametres_confidentialite:{public:!0,commentaires_autorises:!0,telechargement_autorise:!1}}),j=(0,l.useCallback)((e,t)=>{if(t.length>0){h(t[0].errors[0].message);return}let s=e[0];if(s)try{if(d.rb.validateVideoFile(s),x(s),!p.titre){let e=s.name.replace(/\.[^/.]+$/,"");v(t=>({...t,titre:e}))}}catch(e){h(e.message)}},[p.titre,s]),{getRootProps:b,getInputProps:g,isDragActive:N,isDragReject:f}=(0,c.uI)({onDrop:j,accept:{"video/*":[".mp4",".avi",".mov",".wmv",".webm"]},maxFiles:1,maxSize:parseInt("104857600")||104857600}),y=e=>{let{name:t,value:s,type:a,checked:l}=e.target;if(t.startsWith("parametres_confidentialite.")){let e=t.split(".")[1];v(t=>({...t,parametres_confidentialite:{...t.parametres_confidentialite,[e]:"checkbox"===a?l:s}}))}else v(e=>({...e,[t]:"checkbox"===a?l:s}))},k=e=>{let t=e.target.value.split(",").map(e=>e.trim()).filter(e=>e.length>0);v(e=>({...e,tags:t}))},w=async()=>{if(!m||!p.titre.trim()){h("Veuillez s\xe9lectionner un fichier et saisir un titre");return}i(!0),o(0);try{let e=new FormData;e.append("video",m),e.append("titre",p.titre),e.append("description",p.description),e.append("thematique",p.thematique),e.append("tags",JSON.stringify(p.tags)),e.append("parametres_confidentialite",JSON.stringify(p.parametres_confidentialite)),p.evenement_id&&e.append("evenement_id",p.evenement_id);let s=setInterval(()=>{o(e=>e>=90?(clearInterval(s),e):e+10*Math.random())},500),a=await d.K2.uploadVideo(e);clearInterval(s),o(100),setTimeout(()=>{i(!1),o(0),x(null),v({titre:"",description:"",thematique:"autre",tags:[],evenement_id:"",parametres_confidentialite:{public:!0,commentaires_autorises:!0,telechargement_autorise:!1}}),null==t||t(a.data.data.video)},100)}catch(t){i(!1),o(0);let e=d.rb.handleError(t);t.response&&401===t.response.status?h("Votre session a expir\xe9. Veuillez vous reconnecter pour t\xe9l\xe9charger des vid\xe9os."):h(e.message)}let e=()=>{x(null),o(0)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{...b(),className:"dropzone ".concat(N?"active":""," ").concat(f?"reject":""),children:[(0,a.jsx)("input",{...g()}),m?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:(0,a.jsx)("span",{className:"font-medium",children:m.name})}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:d.rb.formatFileSize(m.size)}),(0,a.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),e()},className:"mt-2 text-sm text-red-600 hover:text-red-700",children:"Supprimer"})]}):(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:N?"D\xe9posez votre vid\xe9o ici...":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"font-medium text-blue-600",children:"Cliquez pour s\xe9lectionner"})," ou glissez-d\xe9posez votre vid\xe9o"]})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"MP4, AVI, MOV, WMV, WebM jusqu'\xe0 100MB"})]})]})]}),u&&(0,a.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[(0,a.jsx)("strong",{className:"font-bold",children:"Erreur:"}),(0,a.jsxs)("span",{className:"block sm:inline",children:[" ",u]}),(0,a.jsx)("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",children:(0,a.jsxs)("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",onClick:()=>h(null),children:[(0,a.jsx)("title",{children:"Close"}),(0,a.jsx)("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),r&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Upload en cours..."}),(0,a.jsxs)("span",{className:"text-gray-600",children:[Math.round(n),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(n,"%")}})})]}),m&&!r&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"titre",className:"block text-sm font-medium text-gray-700",children:"Titre de la vid\xe9o *"}),(0,a.jsx)("input",{type:"text",id:"titre",name:"titre",required:!0,className:"input mt-1",placeholder:"Donnez un titre \xe0 votre vid\xe9o",value:p.titre,onChange:y})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,a.jsx)("textarea",{id:"description",name:"description",rows:3,className:"textarea mt-1",placeholder:"D\xe9crivez votre vid\xe9o...",value:p.description,onChange:y})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"thematique",className:"block text-sm font-medium text-gray-700",children:"Th\xe9matique"}),(0,a.jsx)("select",{id:"thematique",name:"thematique",className:"input mt-1",value:p.thematique,onChange:y,children:[{value:"sport",label:"Sport"},{value:"culture",label:"Culture"},{value:"education",label:"\xc9ducation"},{value:"famille",label:"Famille"},{value:"professionnel",label:"Professionnel"},{value:"loisirs",label:"Loisirs"},{value:"voyage",label:"Voyage"},{value:"cuisine",label:"Cuisine"},{value:"technologie",label:"Technologie"},{value:"sante",label:"Sant\xe9"},{value:"autre",label:"Autre"}].map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700",children:"Tags (s\xe9par\xe9s par des virgules)"}),(0,a.jsx)("input",{type:"text",id:"tags",name:"tags",className:"input mt-1",placeholder:"sport, comp\xe9tition, \xe9quipe...",value:p.tags.join(", "),onChange:k})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"evenement_id",className:"block text-sm font-medium text-gray-700",children:"\xc9v\xe9nement associ\xe9 (optionnel)"}),(0,a.jsx)("input",{type:"text",id:"evenement_id",name:"evenement_id",className:"input mt-1",placeholder:"ID de l'\xe9v\xe9nement",value:p.evenement_id,onChange:y})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Param\xe8tres de confidentialit\xe9"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"public",name:"parametres_confidentialite.public",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:p.parametres_confidentialite.public,onChange:y}),(0,a.jsx)("label",{htmlFor:"public",className:"ml-2 block text-sm text-gray-900",children:"Vid\xe9o publique"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"commentaires_autorises",name:"parametres_confidentialite.commentaires_autorises",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:p.parametres_confidentialite.commentaires_autorises,onChange:y}),(0,a.jsx)("label",{htmlFor:"commentaires_autorises",className:"ml-2 block text-sm text-gray-900",children:"Autoriser les commentaires"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{id:"telechargement_autorise",name:"parametres_confidentialite.telechargement_autorise",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:p.parametres_confidentialite.telechargement_autorise,onChange:y}),(0,a.jsx)("label",{htmlFor:"telechargement_autorise",className:"ml-2 block text-sm text-gray-900",children:"Autoriser le t\xe9l\xe9chargement"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:e,className:"btn btn-outline btn-md",children:"Annuler"}),(0,a.jsx)("button",{type:"button",onClick:w,disabled:!p.titre.trim(),className:"btn btn-primary btn-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Publier la vid\xe9o"})]})]})]})}}function m(){let{isAuthenticated:e}=(0,n.a)();(0,r.useRouter)();let[t,s]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[m,x]=(0,l.useState)(null);return e?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-6",children:(0,a.jsx)("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Vid\xe9o upload\xe9e avec succ\xe8s !"}),(0,a.jsxs)("p",{className:"text-lg text-gray-600 mb-8",children:['Votre vid\xe9o "',null==c?void 0:c.titre,'" a \xe9t\xe9 publi\xe9e et est maintenant visible par la communaut\xe9.']}),c&&(0,a.jsx)("div",{className:"card max-w-md mx-auto mb-8",children:(0,a.jsxs)("div",{className:"card-content",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:c.titre}),c.description&&(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:c.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,a.jsx)("span",{className:"badge badge-default",children:c.thematique}),(0,a.jsx)("span",{children:c.statut})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsx)(i.default,{href:"/videos/".concat(null==c?void 0:c.id),className:"btn btn-primary btn-md",children:"Voir ma vid\xe9o"}),(0,a.jsx)("button",{onClick:()=>{s(!1),d(null),x(null)},className:"btn btn-outline btn-md",children:"Uploader une autre vid\xe9o"}),(0,a.jsx)(i.default,{href:"/dashboard",className:"btn btn-ghost btn-md",children:"Retour au tableau de bord"})]}),(0,a.jsxs)("div",{className:"mt-12 max-w-2xl mx-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Et maintenant ?"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(i.default,{href:"/events",className:"card hover:shadow-lg transition-shadow cursor-pointer group",children:(0,a.jsxs)("div",{className:"card-content text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2 group-hover:bg-blue-200 transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"D\xe9couvrir les \xe9v\xe9nements"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Participez \xe0 des \xe9v\xe9nements de votre communaut\xe9"})]})}),(0,a.jsx)(i.default,{href:"/events/create",className:"card hover:shadow-lg transition-shadow cursor-pointer group",children:(0,a.jsxs)("div",{className:"card-content text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2 group-hover:bg-green-200 transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"Cr\xe9er un \xe9v\xe9nement"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Organisez votre propre \xe9v\xe9nement"})]})})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Uploader une vid\xe9o"}),(0,a.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Partagez vos moments avec la communaut\xe9 SpotBulle. T\xe9l\xe9chargez votre vid\xe9o et ajoutez les informations n\xe9cessaires."})]}),(0,a.jsxs)("div",{className:"card mb-8",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"card-title text-lg",children:"Conseils pour un upload r\xe9ussi"})}),(0,a.jsx)("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Formats support\xe9s"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsx)("li",{children:"• MP4 (recommand\xe9)"}),(0,a.jsx)("li",{children:"• AVI, MOV, WMV"}),(0,a.jsx)("li",{children:"• WebM"}),(0,a.jsx)("li",{children:"• Taille max: 100MB"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Bonnes pratiques"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsx)("li",{children:"• Utilisez un titre descriptif"}),(0,a.jsx)("li",{children:"• Ajoutez des tags pertinents"}),(0,a.jsx)("li",{children:"• Choisissez la bonne th\xe9matique"}),(0,a.jsx)("li",{children:"• R\xe9digez une description claire"})]})]})]})})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"card-header",children:[(0,a.jsx)("h2",{className:"card-title",children:"T\xe9l\xe9charger votre vid\xe9o"}),(0,a.jsx)("p",{className:"card-description",children:"S\xe9lectionnez votre fichier vid\xe9o et remplissez les informations"})]}),(0,a.jsx)("div",{className:"card-content",children:(0,a.jsx)(o,{onUploadSuccess:e=>{d(e),s(!0),x(null)},onUploadError:e=>{x(e),s(!1)}})})]}),m&&(0,a.jsx)("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Erreur d'upload"}),(0,a.jsx)("p",{className:"text-sm text-red-700 mt-1",children:m})]}),(0,a.jsx)("div",{className:"ml-auto pl-3",children:(0,a.jsx)("button",{onClick:()=>x(null),className:"text-red-400 hover:text-red-600",children:(0,a.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})})]})})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Acc\xe8s restreint"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Vous devez \xeatre connect\xe9 pour uploader des vid\xe9os."}),(0,a.jsx)(i.default,{href:"/login",className:"btn btn-primary btn-md",children:"Se connecter"})]})})}}},function(e){e.O(0,[825,972,933,950,971,117,744],function(){return e(e.s=792)}),_N_E=e.O()}]);